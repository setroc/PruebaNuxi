CREATE DATABASE Test

GO

USE Test

GO

-- Tabla de usuarios
CREATE TABLE Usuarios (
  	userId INT PRIMARY KEY,
  	Login VARCHAR(100),
  	Nombre VARCHAR(100),
  	Paterno VARCHAR(100),
  	Materno VARCHAR(100)
)

GO
-- Tabla de empleados
CREATE TABLE Empleados  (
	empleadoId INT PRIMARY KEY,
  	userId INT,
  	Sueldo FLOAT,
  	FechaIngreso DATE,
  	CONSTRAINT FK_Usr_Empl FOREIGN KEY (userId) REFERENCES Usuarios (userId)
)

GO

INSERT INTO Usuarios (userId, Login, Nombre, Paterno, Materno) VALUES (1,'BNARANJO','BERE','NARANJO','GONZALEZ'),
(2,'ACAMPOS','ALEXIS','CAMPOS','NARANJO'),
(3,'SCAMPOS','SERGIO ALEJANDRO','CAMPOS','HERNANDEZ'),
(4,'DBERUMEN','DIEGO ISMAEL','BERUMEN','CEDILLO'),
(5,'AESCALANTE','AURORA','ESCALANTE','PALAFOX'),
(6,'JESTRADA','JOYCELENE FABIOLA','ESTRADA','BARBA'),
(7,'FESTRADA','FRANCISCO','ESTRADA','GOMEZ'),
(8,'LFARIAS','LEONARDO DANIEL','FARIAS','ROSAS'),
(9,'RFIERROS','RAMON ANDRES','FIERROS','ROBLES'),
(10,'EFLORES','EDGAR ANDRES','FLORES','OLIVARES'),
(11,'MFRANCO','MARIA FERNANDA','FRANCO','ESQUIVEL'),
(12,'AGALVAN','ALEJANDRO','GALVAN','MUÑIZ'),
(13,'MGUTIERREZ','MARTHA ALICIA','GUTIERREZ','ORTIZ'),
(14,'JHERNANDEZ','JOSAFAT GERARDO','HERNANDEZ','SAUCEDO'),
(15,'RJIMENEZ','ROSALIA','JIMENEZ','GONZALEZ'),
(16,'LJIMENEZ','LAURA CELENE','JIMENEZ','RIOS'),
(17,'ALOPEZ','ANGELICA','LOPEZ','CORTES'),
(18,'CLOPEZ','CRISTIAN IVAN','LOPEZ','GOMEZ'),
(19,'MLOPEZ','MARLENE GABRIELA','LOPEZ','MEZA'),
(20,'AMEDINA','ALEJANDRA','MEDINA','IBARRA'),
(21,'CMEJIA','CONSUELO YURIDIANA THALIA','MEJIA','ALVAREZ'),
(22,'JMEJIA','JAVIER ADRIAN','MEJIA','ALVAREZ'),
(23,'JPEÑA','JUAN CARLOS EVARISTO','PEÑA','GUTIERREZ'),
(24,'JPEREZ','JAZMIN ALEJANDRA','PEREZ','VELEZ'),
(25,'GRAMIREZ','GUSTAVO','RAMIREZ','RIVERA'),
(26,'CRODRIGUEZ','CARLOS NIVARDO','RODRIGUEZ','ASCENCIO'),
(27,'KROMERO','KARLA JOHANA','ROMERO','LUEVANOS'),
(28,'YRUIZ','YESSICA YOSELINNE','RUIZ','HERNANDEZ'),
(29,'CSALAS','CHRISTIAN EDUARDO','SALAS','SANCHEZ'),
(30,'LSALDAÑA','LUIS ROBERTO','SALDAÑA','ESPINOZA'),
(31,'ASANCHEZ','ADRIAN','SANCHEZ','ORTIZ'),
(32,'ESUAREZ','EDUARDO YAIR','SUAREZ','HERNANDEZ'),
(33,'JTABAREZ','JUAN FRANCISCO','TABAREZ','GARCIA'),
(34,'ZTERAN','ZULEICA ELIZABETH','TERAN','TORRES'),
(35,'AVARGAS','ADRIANA YUNUHEN','VARGAS','AYALA'),
(36,'OVELAZQUEZ','OSCAR URIEL','VELAZQUEZ','ALVAREZ'),
(37,'ECORONA','ERICK DE JESUS','CORONA','DIAZ'),
(38,'MRAMOS','MARIA GUADALUPE','RAMOS','HERNANDEZ'),
(39,'JJIMENEZ','JESSICA NOEMI','JIMENEZ','VENTURA'),
(40,'FROJAS','FLOR MARGARITA','ROJAS','HERNANDEZ'),
(41,'LALVARADO','LUIS ANTONIO','ALVARADO','VALENCIA'),
(42,'EAGUILAR','EDGAR IVAN','AGUILAR','PADILLA'),
(43,'LMICHEL','LUIS ALFONSO','MICHEL','SANCHEZ'),
(44,'JSILVA','JOSE CARLOS','SILVA','ROCHA'),
(45,'JRODRIGUEZ','JUDITH','RODRIGUEZ','REYES'),
(46,'BCHAVEZ','BRENDA SORAYA','CHAVEZ','GARCIA'),
(47,'AMARQUEZ','ALMA ROSA','MARQUEZ','AGUILA')

GO

INSERT INTO Empleados (empleadoId, userId, Sueldo, FechaIngreso) VALUES (1,1,8837,'2000-01-11'),
(2,2,8837,'2000-01-11'),
(3,3,15000,'2000-01-11'),
(4,4,15000,'2000-01-11'),
(5,5,7812,'2000-01-18'),
(6,6,7812,'2000-01-18'),
(7,7,10200,'2000-01-18'),
(8,8,10200,'2000-01-18'),
(9,9,13800,'2001-05-20'),
(10,10,13800,'2001-05-20'),
(11,11,18880,'2001-05-20'),
(12,12,18880,'2001-05-20'),
(13,13,8000,'2001-07-13'),
(14,14,8000,'2001-07-13'),
(15,15,6000,'2001-07-13'),
(16,16,19470,'2001-07-13'),
(17,17,19470,'2001-07-13'),
(18,18,10200,'2001-07-16'),
(19,19,10200,'2001-07-16'),
(20,20,25000,'2001-07-16'),
(21,21,7812,'2001-07-16'),
(22,22,7812,'2001-07-16'),
(23,23,12210,'2001-11-24'),
(24,24,12210,'2001-11-24'),
(25,25,7500,'2001-11-24'),
(26,26,15020,'2001-11-24'),
(27,27,15020,'2001-11-24'),
(28,28,25000,'2001-11-24'),
(29,29,7812,'2001-11-24'),
(30,30,15020,'2001-12-12'),
(31,31,15020,'2001-12-12'),
(32,32,12210,'2001-12-12'),
(33,33,12210,'2001-12-12'),
(34,34,19470,'2008-08-17'),
(35,35,19470,'2008-08-17'),
(36,36,8000,'2008-08-17'),
(37,37,8000,'2008-08-17'),
(38,38,18880,'2009-06-11'),
(39,39,18880,'2009-06-11'),
(40,40,14000,'2009-06-11'),
(41,41,13800,'2009-06-11'),
(42,42,13800,'2009-06-11'),
(43,43,15000,'2009-10-06'),
(44,44,15000,'2009-10-06'),
(45,45,13000,'2009-10-06'),
(46,46,8837,'2009-10-06')

GO


-- querys

-- Depurar solo los ID diferentes de 6,7,9 y 10 de la tabla usuarios
SELECT * FROM Usuarios u  WHERE u.userId NOT IN (6,7,9,10)

-- Actualizar el dato Sueldo en un 10 porciento a los empleados que tienen fechas entre el año 2000 y 2001 
UPDATE Empleados SET Sueldo = (Sueldo * 1.1) WHERE DATEPART(YEAR, FechaIngreso) IN (2000, 2001)

-- Realiza una consulta para traer el nombre de usuario y fecha de ingreso de los usuarios que gananen mas de 10000 y su apellido comience con T 
-- ordernado del mas reciente al mas antiguo

SELECT
	u.Nombre,
	e.FechaIngreso
FROM Usuarios u
INNER JOIN Empleados e ON e.userId = u.userId 
WHERE e.Sueldo > 10000 
AND (u.Paterno like 'T%' OR u.Materno like 'T%')
ORDER BY e.FechaIngreso DESC

-- Realiza una consulta donde agrupes a los empleados por sueldo, un grupo con los que ganan menos de 1200 y uno mayor o igual a 1200, cuantos hay en cada grupo? 
SELECT
    (CASE WHEN e.Sueldo < 1200 THEN 'Menor de 1200' ELSE '1200 o mayor' END) AS Categoria,
    COUNT(*) AS Cantidad
FROM Empleados e 
GROUP BY (CASE WHEN e.Sueldo < 1200 THEN 'Menor de 1200' ELSE '1200 o mayor' END)
